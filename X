-- ✅ Pet Predictor – Now Executor-Friendly

spawn(function()
    local ok, err = pcall(function()
        -- Wait for the game to load
        repeat wait() until game:IsLoaded()

        -- Services
        local Players = game:GetService("Players")
        local Workspace = game:GetService("Workspace")
        local TweenService = game:GetService("TweenService")

        local LocalPlayer = Players.LocalPlayer
        local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

        -- Egg -> Pets mapping
        local eggToPets = {
            ["Common Egg"] = {"Dog","Golden Lab","Bunny"},
            ["Uncommon Egg"] = {"Black Bunny","Cat","Chicken","Deer"},
            ["Rare Egg"] = {"Monkey","Orange Tabby","Pig","Rooster","Spotted Deer"},
            ["Legendary Egg"] = {"Cow","Silver Monkey","Sea Otter","Turtle","Polar Bear"},
            ["Mythical Egg"] = {"Grey Mouse","Brown Mouse","Squirrel","Red Giant Ant","Red Fox"},
            ["Bug Egg"] = {"Snail","Giant Ant","Caterpillar","Praying Mantis","Dragonfly"},
            ["Bee Egg"] = {"Bee","Honey Bee","Bear Bee","Petal Bee","Queen Bee"},
            ["Paradise Egg"] = {"Ostrich","Peacock","Capybara","Scarlet Macaw","Mimic Octopus"},
            ["Oasis Egg"] = {"Meerkat","Sand Snake","Axolotl","Hyacinth Macaw"},
            ["Grow a Garden Egg"] = {"Sprout","Tiny Flower","Green Caterpillar","Garden Snail","Mystic Gnome"},
        }

        -- ESP handling
        local espList = {}
        local function clearESP()
            for _, gui in ipairs(espList) do
                if gui and gui.Parent then gui:Destroy() end
            end
            espList = {}
        end

        local function createESP(part, eggName, petName)
            if not part:IsA("BasePart") or part:FindFirstChild("EggESP") then return end
            local gui = Instance.new("BillboardGui", part)
            gui.Name = "EggESP"
            gui.Size = UDim2.new(0, 150, 0, 40)
            gui.StudsOffset = Vector3.new(0, 2.5, 0)
            gui.AlwaysOnTop = true
            gui.Adornee = part

            local label = Instance.new("TextLabel", gui)
            label.Size = UDim2.new(1,0,1,0)
            label.BackgroundTransparency = 1
            label.TextScaled = true
            label.Font = Enum.Font.FredokaOne
            label.Text = eggName.." | "..petName

            -- Color rare pets red
            if petName == eggToPets[eggName][#eggToPets[eggName]] then
                label.TextColor3 = Color3.fromRGB(255,0,0)
            else
                label.TextColor3 = Color3.new(1,1,1)
            end

            table.insert(espList, gui)
        end

        local function getRandomPet(eggName, forceRare, blockRare)
            local pool = eggToPets[eggName]
            if not pool then return "Unknown" end
            if forceRare then
                return pool[#pool]
            elseif blockRare then
                return pool[ math.random(1, #pool-1) ]
            else
                return pool[ math.random(1, #pool) ]
            end
        end

        local function randomizeEggs(forceRare, blockRare)
            clearESP()
            local found = {}
            for _, mdl in ipairs(Workspace:GetDescendants()) do
                if mdl:IsA("Model") and eggToPets[mdl.Name] then
                    local part = mdl:FindFirstChildWhichIsA("BasePart")
                    if part then
                        local pet = getRandomPet(mdl.Name, forceRare, blockRare)
                        createESP(part, mdl.Name, pet)
                        if pet == eggToPets[mdl.Name][#eggToPets[mdl.Name]] then
                            table.insert(found, mdl.Name.." | "..pet)
                        end
                    end
                end
            end
            return found
        end

        -- ➕ Loading GUI
        local loading = Instance.new("ScreenGui", PlayerGui)
        loading.Name = "KuniLoading"
        loading.IgnoreGuiInset = true

        local box = Instance.new("Frame", loading)
        box.Size = UDim2.new(0,240,0,100)
        box.Position = UDim2.new(0.5,-120,0.5,-50)
        box.BackgroundColor3 = Color3.fromRGB(40,40,40)
        Instance.new("UICorner", box).CornerRadius = UDim.new(0,12)

        local title = Instance.new("TextLabel", box)
        title.Size = UDim2.new(1,0,0.4,0)
        title.Text = "Kuni Hub"
        title.Font = Enum.Font.GothamBold
        title.TextColor3 = Color3.new(1,1,1)
        title.BackgroundTransparency = 1
        title.TextScaled = true

        local stat = Instance.new("TextLabel", box)
        stat.Size, stat.Position = UDim2.new(1,0,0.3,0), UDim2.new(0,0,0.4,0)
        stat.Text = "Loading..."
        stat.Font = Enum.Font.Gotham
        stat.TextColor3 = Color3.new(1,1,1)
        stat.BackgroundTransparency = 1
        stat.TextScaled = true

        local barBG = Instance.new("Frame", box)
        barBG.Size = UDim2.new(0.9,0,0,8)
        barBG.Position = UDim2.new(0.05,0,1,-20)
        barBG.BackgroundColor3 = Color3.fromRGB(60,60,60)
        Instance.new("UICorner", barBG).CornerRadius = UDim.new(0,5)
        local bar = Instance.new("Frame", barBG)
        bar.Size = UDim2.new(0,0,1,0)
        bar.BackgroundColor3 = Color3.fromRGB(255,215,0)
        Instance.new("UICorner", bar).CornerRadius = UDim.new(0,5)

        for i = 1,30 do
            bar.Size = UDim2.new(i/30,0,1,0)
            stat.Text = "Loading"..string.rep(".", i%4)
            wait(0.33)
        end
        loading:Destroy()
        wait(10)

        -- ➕ Main GUI
        local main = Instance.new("ScreenGui", PlayerGui)
        main.Name = "KuniHubGUI"
        main.IgnoreGuiInset = true

        local frm = Instance.new("Frame", main)
        frm.Size = UDim2.new(0,230,0,140)
        frm.Position = UDim2.new(0.02,0,0.4,0)
        frm.BackgroundColor3 = Color3.fromRGB(20,20,20)
        frm.Active, frm.Draggable = true, true
        Instance new("UICorner", frm).CornerRadius = UDim.new(0,12)

        local close = Instance.new("TextButton", frm)
        close.Size, close.Position = UDim2.new(0,22,0,22), UDim2.new(1,-26,0,4)
        close.Text, close.Font, close.TextColor3 = "✕", Enum.Font.GothamBold, Color3.new(1,0.4,0.4)
        close.BackgroundColor3 = Color3.fromRGB(40,40,40)
        Instance new("UICorner", close).CornerRadius = UDim.new(0,4)
        close.MouseButton1Click:Connect(function() main:Destroy() end)

        local randBtn = Instance.new("TextButton", frm)
        randBtn.Size, randBtn.Position = UDim2.new(0.9,0,0,26), UDim2.new(0.05,0,0,85)
        randBtn.Text, randBtn.Font, randBtn.TextColor3 = "Randomize Pet", Enum.Font.GothamBold, Color3.fromRGB(255,215,0)
        randBtn.BackgroundColor3 = Color3.fromRGB(40,40,40)
        Instance new("UICorner", randBtn).CornerRadius = UDim.new(0,8)

        local autoBtn = Instance.new("TextButton", frm)
        autoBtn.Size, autoBtn.Position = UDim2.new(0.9,0,0,26), UDim2.new(0.05,0,0,116)
        autoBtn.Text, autoBtn.Font, autoBtn.TextColor3 = "Auto Roll Rare", Enum.Font.GothamBold, Color3.fromRGB(255,215,0)
        autoBtn.BackgroundColor3 = Color3.fromRGB(70,40,40)
        Instance new("UICorner", autoBtn).CornerRadius = UDim.new(0,8)

        local statusLabel = Instance.new("TextLabel", frm)
        statusLabel.Size, statusLabel.Position = UDim2.new(1,-20,0,20), UDim2.new(0,10,0,58)
        statusLabel.TextColor3 = Color3.new(1,1,1)
        statusLabel.BackgroundTransparency = 1
        statusLabel.Font = Enum.Font.Gotham
        statusLabel.TextScaled = true

        local canClick = true
        randBtn.MouseButton1Click:Connect(function()
            if not canClick then return end
            canClick = false
            statusLabel.Text = "Randomizing..."
            randomizeEggs(false,false)
            wait(2)
            statusLabel.Text = ""
            canClick = true
        end)

        autoBtn.MouseButton1Click:Connect(function()
            if not canClick then return end
            canClick = false
            local start = tick()
            while tick() - start < 39 do
                statusLabel.Text = "Rolling..."
                randomizeEggs(false,true)
                wait(0.25)
                statusLabel.Text = ""
                wait(0.25)
            end
            local rares = randomizeEggs(true,false)
            statusLabel.Text = (#rares>0 and "✔ Rare Found:\n"..table.concat(rares,"\n") or "✔ Rare Pet Found")
            wait(3)
            statusLabel.Text = ""
            canClick = true
        end)
    end)
    if not ok then
        warn("Pet Predictor Error: "..tostring(err))
    end
end)
